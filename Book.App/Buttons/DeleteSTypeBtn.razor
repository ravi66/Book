@using Book.Models;
@using Book.Pages

<MudTooltip Text="Delete Summary Type" Delay="500" Duration="0" ShowOnFocus="false" >
    <MudIconButton Variant="@Variant" Size="@Size" Icon="@Icons.Material.Filled.Delete" Color="Color.Secondary" OnClick="Delete" aria-label="delete summary type" />
</MudTooltip>

@code
{
    [Parameter] public SummaryType SummaryType { get; set; }

    [Parameter] public Variant Variant { get; set; }

    [Parameter] public Size Size { get; set; }

    [Parameter] public STypeDialog? STypeDialog { get; set; }

    [Parameter] public SummaryTypeList? SummaryTypeList { get; set; }

    [Inject] public IDialogService DialogService { get; set; }

    [Inject] internal ISummaryTypeRepository Repo { get; set; }

    async Task Delete()
    {
        var parameters = new DialogParameters<ConfirmDialog>
        {
            { x => x.ConfirmationTitle, $"Delete {SummaryType.Name} Summary Type" },
            { x => x.ConfirmationMessage, $"Are you sure you want to delete this Summary Type?" },
            { x => x.CancelColorInt, 0 },
            { x => x.DoneColorInt, 1 }
        };

        var dialog = DialogService.Show<ConfirmDialog>("Confirm", parameters);
        var result = await dialog.Result;

        if (!result.Canceled)
        {
            await Repo.DeleteSummaryType(SummaryType.SummaryTypeId);

            if (STypeDialog != null) STypeDialog.CloseReload();
            if (SummaryTypeList != null) SummaryTypeList.LoadSummaryTypes();
        }
    }
}
