@using Book.Models;
@using Book.Pages

<MudTooltip Text="Delete Entry Type" Delay="500" Duration="0" ShowOnFocus="false" >
    <MudIconButton Variant="@Variant" Size="@Size" Icon="@Icons.Material.Filled.Delete" Color="Color.Secondary" OnClick="Delete" aria-label="delete entry type" />
</MudTooltip>

@code
{
    [Parameter] public TransactionType TransactionType { get; set; }

    [Parameter] public Variant Variant { get; set; }

    [Parameter] public Size Size { get; set; }

    [Parameter] public TTypeDialog? TTypeDialog { get; set; }

    [Parameter] public SummaryTypeList? SummaryTypeList { get; set; }

    [Inject] public IDialogService DialogService { get; set; }

    [Inject] public TransactionTypeRepository Repo { get; set; }

    async Task Delete()
    {
        var parameters = new DialogParameters<ConfirmDialog>
        {
            { x => x.ConfirmationTitle, $"Delete {TransactionType.Name} Entry Type" },
            { x => x.ConfirmationMessage, $"Are you sure you want to delete this Entry Type?" },
            { x => x.CancelColorInt, 0 },
            { x => x.DoneColorInt, 1 }
        };

        var dialog = DialogService.Show<ConfirmDialog>("Confirm", parameters);
        var result = await dialog.Result;

        if (!result.Canceled)
        {
            await Repo.DeleteTransactionType(TransactionType.TransactionTypeId);

            if (TTypeDialog != null) TTypeDialog.CloseReload();
            if (SummaryTypeList != null) SummaryTypeList.LoadSummaryTypes();
        }
    }
}
