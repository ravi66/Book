@page "/summarytypelist"
@implements IDisposable

<PageTitle>@BookName - @Localizer["Types"]</PageTitle>

<MudContainer Class="ma-0 pa-2">
    <MudGrid>
        <MudItem xs="12" md="6" Class="px-1">
            <MudTable Elevation="5" T="SummaryType" Items="@SummaryTypes" Dense="true" Hover="true" SortLabel="@Localizer["SortBy"]" AllowUnsorted="false" SelectedItemChanged="SummaryChanged" Outlined="true">
                <ToolBarContent>
                    <MudIconButton Icon="@Icons.Material.Filled.Summarize" Variant="Variant.Filled" Color="Color.Primary" Size="Size.Medium" OnClick="AddSummaryType" Title="@Localizer["NewSummaryType"]" />
                    <MudText Class="ps-2 py-0" Typo="Typo.h5">@Localizer["Summaries"]</MudText>
                </ToolBarContent>
                <HeaderContent>
                    <MudTh Class="py-0"><MudTableSortLabel SortBy="new Func<SummaryType, object>(x=>x.Name)">@Localizer["Name"]</MudTableSortLabel></MudTh>
                    <MudTh Class="py-0"><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<SummaryType, object>(x=>x.Order)">@Localizer["Order"]</MudTableSortLabel></MudTh>
                    <MudTh Class="py-0"><MudTableSortLabel SortBy="new Func<SummaryType, object>(x=>x.CreateDate)">@Localizer["Created"]</MudTableSortLabel></MudTh>
                    <MudTh Class="py-0">@Localizer["Tools"]</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="@Localizer["Name"]">@context.Name</MudTd>
                    <MudTd DataLabel="@Localizer["Order"]">@context.Order</MudTd>
                    <MudTd DataLabel="@Localizer["Created"]">@context.CreateDate.ToShortDateString()</MudTd>
                    <MudTd DataLabel="@Localizer["Tools"]">
                        <MudIconButton Class="py-0" Icon="@Icons.Material.Filled.Edit" Color="Color.Primary" Size="Size.Small" Title="@Localizer["EditSummaryType"]" OnClick="() => EditSType(context.SummaryTypeId)" />
                        @if (context.TransactionTypes.Any())
                        {
                            <MudIconButton Class="py-0" Icon="@Icons.Material.Filled.PointOfSale" Color="Color.Primary" Size="Size.Small" Title="@Localizer["ListEntriesForSummaryType"]" OnClick="()=> ListTransactionsSummary(context)" />
                            <MudIconButton Class="py-0" Icon="@Icons.Material.Filled.ShowChart" Color="Color.Primary" Size="Size.Small" Title="@Localizer["SummaryTypeChart"]" OnClick="()=> SummaryTypeChart(context)" />
                        }
                        else if (context.SummaryTypeId > 0)
                        {
                            <DeleteSTypeBtn SummaryType="@context" Size="@Size.Small" Variant="@Variant.Text" />
                        }
                    </MudTd>
                </RowTemplate>
            </MudTable>
        </MudItem>
        <MudItem xs="12" md="6" Class="px-1">
            <MudTable Items="@TransactionTypes" T="TransactionType" Hover="true" SortLabel="@Localizer["SortBy"]" AllowUnsorted="true" Elevation="5" Outlined="true" Dense="true">
                <ToolBarContent>
                    <MudIconButton Icon="@Icons.Material.Filled.Receipt" Variant="Variant.Filled" Color="Color.Primary" Size="Size.Medium" OnClick="() => AddTransactionType(CurrentSummaryTypeId)" Title="@Localizer["NewEntryType"]" />
                    <MudText Class="ps-2 py-0" Typo="Typo.h5"><strong>@CurrentSummaryName</strong> @Localizer["EntryTypes"]</MudText>
                </ToolBarContent>
                <HeaderContent>
                    <MudTh Class="py-0"><MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<TransactionType, object>(x=>x.Name)">@Localizer["Name"]</MudTableSortLabel></MudTh>
                    <MudTh Class="py-0"><MudTableSortLabel SortBy="new Func<TransactionType, object>(x=>x.CreateDate)">@Localizer["Created"]</MudTableSortLabel></MudTh>
                    <MudTh Class="py-0">@Localizer["Tools"]</MudTh>
                </HeaderContent>
                <NoRecordsContent>
                    <MudText>@Localizer["NoEntryTypesFound"]</MudText>
                </NoRecordsContent>
                <RowTemplate>
                    <MudTd DataLabel="@Localizer["Name"]">@context.Name</MudTd>
                    <MudTd DataLabel="@Localizer["Created"]">@context.CreateDate.ToShortDateString()</MudTd>
                    <MudTd DataLabel="@Localizer["Tools"]">
                        <MudIconButton Class="py-0" Icon="@Icons.Material.Filled.Edit" Color="Color.Primary" Size="Size.Small" Title="@Localizer["EditEntryType"]" OnClick="()=> EditTType(context.TransactionTypeId)" />
                        <MudIconButton Class="py-0" Icon="@Icons.Material.Filled.PointOfSale" Color="Color.Primary" Size="Size.Small" Title="@Localizer["ListEntriesForEntryType"]" OnClick="()=> ListTransactionsTType(context)" />
                        <MudIconButton Class="py-0" Icon="@Icons.Material.Filled.ShowChart" Color="Color.Primary" Size="Size.Small" Title="@Localizer["EntryTypeChart"]" OnClick="()=> EntryTypeChart(context)" />
                        @if (context.TransactionCount < 1 && context.TransactionTypeId > -1)
                        {
                            <DeleteTTypeBtn TransactionType="@context" Variant="@Variant.Text" Size="@Size.Small" />
                        }
                    </MudTd>
                </RowTemplate>
            </MudTable>
        </MudItem>
    </MudGrid>
</MudContainer>
